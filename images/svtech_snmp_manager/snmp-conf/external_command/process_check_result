#!/bin/sh

host="$1"
service="$2"
plugin_output="$3"
exit_status=$4
request_host="https://$ICINGA_HOST:$ICINGA_PORT"
userpass="$ICINGA_USER:$ICINGA_PASSWORD"
data_json="{ \"exit_status\": $exit_status, \"plugin_output\": \"$plugin_output\", \"pretty\": true }"

/usr/bin/curl -s -k -H 'Accept: application/json' -X POST -d "$data_json" -u "$userpass" "$request_host/v1/actions/process-check-result?service=$host!$service"
